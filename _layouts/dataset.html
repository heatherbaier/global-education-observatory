<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ page.title }}</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>

<body class="bg-gray-50 text-gray-800">

  <div class="max-w-5xl mx-auto py-10 px-4">
    <!-- Title -->
    <h1 class="text-4xl font-bold mb-4">
      {{ page.country }} — {{ page.theme | capitalize }} Data
    </h1>

    <!-- Description -->
    <p class="text-gray-700 mb-6">
      {{ site.data[page.theme].metadata.description }}
    </p>

    <!-- Metadata Table -->
    <h2 class="text-2xl font-semibold mb-3">Metadata</h2>

    <!-- <table class="w-full bg-white rounded-xl shadow mb-8 border">
      <tr class="bg-gray-100 border-b">
        <th class="p-2 text-left font-semibold">Column</th>
        <th class="p-2 text-left font-semibold">Description</th>
      </tr>

      {% for col, desc in site.data[page.theme].metadata.columns %}
      <tr class="border-b">
        <td class="p-2">{{ col }}</td>
        <td class="p-2 text-gray-700">{{ desc }}</td>
      </tr>
      {% endfor %}
    </table> -->

    <!-- Download Tiles -->
    <h2 class="text-2xl font-semibold mb-3">Download Data</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">

      <!-- GeoJSON -->
      <a href="{{ page.file }}" class="block p-6 bg-white shadow rounded-xl hover:shadow-lg transition text-center">
        <i class="fa-solid fa-map text-4xl text-blue-600 mb-2"></i>
        <div class="text-lg font-semibold">Download GeoJSON</div>
        <div class="text-sm text-gray-600">{{ page.country }} geospatial data</div>
      </a>

      <!-- CSV -->
      {% if page.csv %}
      <a href="{{ page.csv }}" class="block p-6 bg-white shadow rounded-xl hover:shadow-lg transition text-center">
        <i class="fa-solid fa-table text-4xl text-green-600 mb-2"></i>
        <div class="text-lg font-semibold">Download CSV</div>
        <div class="text-sm text-gray-600">{{ page.country }} CSV data</div>
      </a>
      {% endif %}
    </div>

    <!-- Map -->
    <h2 class="text-2xl font-semibold mb-3">Preview Map (first 10 points)</h2>

    <div id="map" class="h-96 w-full rounded-xl shadow"></div>

  </div>

  <!-- Map Script -->
  <script>
    const map = L.map('map').setView([14.5, -86.4], 7); // Honduras center approx

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 12,
      attribution: '© OpenStreetMap'
    }).addTo(map);

    // Load GeoJSON
    fetch("{{ page.file }}")
      .then(res => res.json())
      .then(data => {
        let features = data.features.slice(0, 10); // first 10 points

        L.geoJSON(features, {
          pointToLayer: (feature, latlng) => L.marker(latlng)
        }).addTo(map);
      });
  </script>

</body>
</html>
